!function(e){function t(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild.data}function a(e,a,r){var i=document.createElementNS("http://www.w3.org/2000/svg",e);for(var l in a)i.setAttribute(l,a[l]);return r&&(i.textContent=t(r)),i}var r="#999",i="#6bb8b6";prettyNumber=function(e){return exp_number=e.toExponential(),notation_parts=exp_number.split("e"),notation=notation_parts[1],e>=1e9?(notation_string="b",number_part=e/1e9):e>=1e6?(notation_string="m",number_part=e/1e6):e>=1e3?(notation_string="k",number_part=e/1e3):(notation_string="",number_part=e),number_part=number_part<10?Math.round(10*number_part)/10:Math.round(number_part),number_part+notation_string},e.fn.drawDonut=function(t,i){var l,n,s,o=e(this),p=i.has_key,c=i.has_key?200:100,d=100,h=i.colors,u=c/2,v=d/2,_=Math.min(u,v),f=i.donut_thickness.indexOf("%")>-1?2*_*parseInt(i.donut_thickness)/100:parseInt(i.donut_thickness),g=_-f,x=(i.background_color||"#fff",i.full_donut),m=i.title,y=i.no_text||!1,w=i.goal_value,k=i.rounded||!1,M=i.no_tip||!1,b=Math.cos,L=Math.sin,j=Math.PI,C=x?2*j:1.5*j,I=e('<svg width="100%" height="100%" viewBox="0, 0, '+c+", "+d+'" xmlns="http://www.w3.org/2000/svg"></svg>').appendTo(o),P=[],N=0;"undefined"!=typeof i.start_angle?(l=i.start_angle,n=_+_*b(l),s=_-_*L(l)):(l=x?3*j/2:5*j/4,n=x?_:_-_*b(j/4),s=x?2*_:_+_*L(j/4));for(var A=0;A<t.length;A++)N+=t[A].value;var T=N,Z=!1;if(w&&w>N?(t.push({name:"Remaining",value:w-N}),0==N&&(Z=!0),N=w):1==t.length&&x&&(Z=!0),N>0)for(var A=0;A<t.length;A++){var B,H,W=t[A],X=W.value/N*C,Y=_+_*b(l-X),E=_-_*L(l-X),O=_+g*b(l-X),S=_-g*L(l-X),D=h[A%h.length];X>=j?(B="0 1 1",H="0 1 0"):(B="0 0 1",H="0 0 0");var F,Q=0!=A||x?"0 0 0":"0 0 1";if(Z&&W.value>0)var R=a("circle",{cx:_,cy:_,r:g+f/2,stroke:D,"stroke-width":f,fill:"none","data-title":W.name,"data-value":W.value,"class":"graph_piece"});else{F=k?["M",n,s,"A",_,_,B,Y,E,"A",f/2,f/2,"0 1 1",O,S,"A",g,g,H,_+g*b(l),_-g*L(l),"A",f/2,f/2,Q,n,s,"Z"]:["M",n,s,"A",_,_,B,Y,E,"L",O,S,"A",g,g,H,_+g*b(l),_-g*L(l),"L",n,s,"Z"];var R=a("path",{d:F.join(" "),fill:D,"data-title":W.name,"data-value":W.value,"class":"graph_piece"})}I.append(R),n=Y,s=E,l=l-X>0?(l-X)%(2*j):l-X+2*j,P.push({color:D,title:W.name,percentage:Math.round(100*(W.value/N))})}if(!y)if(x)var q=a("text",{x:_,y:_,"text-anchor":"middle","class":"center_large"},prettyNumber(T)),z=a("text",{x:_,y:_+g/4,fill:r,"text-anchor":"middle","class":"center_small"},m);else var q=a("text",{x:_,y:_+3*g/4+f/2,"text-anchor":"middle","class":"center_large"},prettyNumber(T)),z=a("text",{x:_,y:2*_-f/2,fill:r,"text-anchor":"middle","class":"center_small"},m);if(I.append(q),I.append(z),p)for(var G=d/P.length,J=Math.min(5,G),A=0;A<P.length;A++){var K=P[A],U=a("circle",{cx:u+2*J,cy:A*G+J,r:J,fill:K.color,"class":"key_circle"}),V=a("text",{x:u+4*J,y:A*G+1.5*J,fill:r,"class":"key_text"},K.title+" ("+K.percentage+"%)");I.append(U),I.append(V)}if(!M){var $=e('<div class="chart_tip"><span class="title"></span><span class="value"></span></div>').appendTo("body");o.on("mouseover","path.graph_piece, circle.graph_piece",function(){$.find("span.title").html(e(this).data("title")),$.find("span.value").text(prettyNumber(e(this).data("value"))),$.show()}),o.on("mouseleave","path.graph_piece, circle.graph_piece",function(){$.hide()}),o.on("mousemove","path.graph_piece, circle.graph_piece",function(e){$.css({left:e.pageX-$.outerWidth()/2+"px",top:e.pageY-$.outerHeight(!0)+"px"})})}return o.addClass("chart").addClass("donut_chart"),p&&o.addClass("has_key"),o},e.fn.drawPie=function(t,i){for(var l=e(this),n=i.has_key?200:100,s=100,o=i.colors,p=n/2,c=s/2,d=i.title,h=i.has_key,u=d?10:0,v=Math.min(p,c-u),_=Math.cos,f=Math.sin,g=Math.PI,x=2*g,m=e('<svg width="100%" height="100%" viewBox="0, 0, '+n+", "+s+'" xmlns="http://www.w3.org/2000/svg"></svg>').appendTo(l),y=!1,w=[],k=0,M=v,b=u+v+v,L=3*g/2,j=0;j<t.length;j++)k+=t[j].value;if(1==t.length&&(y=!0),k>0)for(var j=0;j<t.length;j++){var C,I,P=t[j],N=P.value/k*x,A=v+v*_(L-N),T=u+v-v*f(L-N),Z=o[j%o.length];if(y=P.value==k?!0:!1,L>g/2&&3*g/2>=L?N>=g?(C="0 1 1",I="0 1 0"):(C="0 0 1",I="0 0 0"):N>=g?(C="0 0 1",I="0 0 0"):(C="0 0 1",I="0 0 0"),P.value>0)if(y)var B=a("circle",{cx:v,cy:v+u,r:v,fill:Z,"data-title":P.name,"data-value":P.value,"class":"graph_piece"});else var H=["M",v,v+u,"L",M,b,"A",v,v,C,A,T,"L",v,v+u,"Z"],B=a("path",{d:H.join(" "),fill:Z,"data-title":P.name,"data-value":P.value,"class":"graph_piece"});m.append(B),M=A,b=T,L-=N,w.push({color:Z,title:P.name,percentage:Math.round(100*(P.value/k))})}if(h)for(var W=(s-u)/w.length,X=Math.min(5,W),j=0;j<w.length;j++){var Y=w[j],E=a("circle",{cx:p+2*X,cy:u+j*W+X,r:X,fill:Y.color,"class":"key_circle"}),O=a("text",{x:p+4*X,y:u+j*W+1.5*X,fill:r,"class":"key_text"},Y.title+" ("+Y.percentage+"%)");m.append(E),m.append(O)}if(d){var S=a("text",{x:n/2,y:5,fill:r,"text-anchor":"middle","class":"key_text"},d);m.append(S)}var D=e('<div class="chart_tip"><span class="title"></span><span class="value"></span></div>').appendTo("body");return l.on("mouseover","path.graph_piece, circle.graph_piece",function(){D.find("span.title").html(e(this).data("title")),D.find("span.value").text(prettyNumber(e(this).data("value"))),D.show()}),l.on("mouseleave","path.graph_piece, circle.graph_piece",function(){D.hide()}),l.on("mousemove","path.graph_piece, circle.graph_piece",function(e){D.css({left:e.pageX-D.outerWidth()/2+"px",top:e.pageY-D.outerHeight(!0)+"px"})}),l.addClass("chart").addClass("pie_chart"),h&&l.addClass("has_key"),l},e.fn.drawSkew=function(t,i){var l=e(this),n=i.has_key?200:100,s=100,o=i.colors,p=i.border_color,c=i.data_max||10,d=i.show_fit;fit_master=i.fit_master||0,fit_comparison=(fit_master+1)%2,title=i.title,has_key=i.has_key,edge_tooltips=i.edge_tooltips||!1,categories=i.categories||!1,categories_colors=i.categories_colors,dot_radius=1.5,offset_top=title?10:2*dot_radius,offset_bottom=d?10:2*dot_radius,center_x=n/2,center_y=s/2,inner_radius=Math.min(center_x-2*dot_radius,center_y-(offset_top+offset_bottom)/2),outer_radius=inner_radius+2*dot_radius,start_x=i.has_key?inner_radius+dot_radius:center_x,start_y=inner_radius+offset_top,cos=Math.cos,sin=Math.sin,PI=Math.PI,total_radians=2*PI;var h=e('<svg width="100%" height="100%" viewBox="0, 0, '+n+", "+s+'" xmlns="http://www.w3.org/2000/svg"></svg>').appendTo(l),u=a("circle",{cx:start_x,cy:start_y,r:inner_radius,stroke:p,"stroke-width":"0.5%",fill:"none"});h.append(u);for(var v=[],_=t[0].values.length,f=2*PI/_,g="",x=1*PI/2,m=0,y=[],w=[],k={},M=x,b=0,L=0;L<t[0].values.length;L++){var j=t[0].values[L],C=start_x+inner_radius*cos(M),I=start_y-inner_radius*sin(M);if(edge_tooltips){var P=a("circle",{cx:C,cy:I,r:dot_radius,fill:p,"data-title":j.name,"data-value":y[L].join("<br/>"),"class":"graph_piece"});h.append(P),M+=f}if(categories){if("string"==typeof j.category)var N=j.category,A="";else if("object"==typeof j.category)var N=j.category.name,A=j.category.subtitle;N in k?k[N].length+=1:(k[N]={length:1,color:categories_colors[b%categories_colors.length],value:A},b++)}d&&2==t.length&&(m+=1-Math.max(t[fit_master].values[L].value-t[fit_comparison].values[L].value,0)/c)}if(categories&&k){var T=x+PI/_,Z=start_x+outer_radius*cos(T);category_start_y=start_y-outer_radius*sin(T);for(var N in k)if(k.hasOwnProperty(N)){var B,H,W=k[N],X=W.length/_*total_radians,Y=start_x+outer_radius*cos(T-X),E=start_y-outer_radius*sin(T-X),O=start_x+inner_radius*cos(T-X),S=start_y-inner_radius*sin(T-X),D=W.color;X>=PI?(B="0 1 1",H="0 1 0"):(B="0 0 1",H="0 0 0");var F;if(1==b)var P=a("circle",{cx:start_x,cy:start_y,r:inner_radius+dot_radius,stroke:D,"stroke-width":2*dot_radius,fill:"none","data-title":N,"data-value":W.value,"class":"graph_piece"});else{F=["M",Z,category_start_y,"A",outer_radius,outer_radius,B,Y,E,"L",O,S,"A",inner_radius,inner_radius,H,start_x+inner_radius*cos(T),start_y-inner_radius*sin(T),"L",Z,category_start_y,"Z"];var P=a("path",{d:F.join(" "),fill:D,"data-title":N,"data-value":W.value,"class":"graph_piece"})}h.append(P),Z=Y,category_start_y=E,T=T-X>0?(T-X)%(2*PI):T-X+2*PI}}for(var Q=0;Q<t.length;Q++){for(var g=[],R=t[Q].title,q=x,L=0;L<t[Q].values.length;L++){var j=t[Q].values[L],C=start_x+inner_radius*j.value/c*cos(q),I=start_y-inner_radius*j.value/c*sin(q),D=o[Q%o.length];if(g.push(C+","+I),q+=f,edge_tooltips)y[L]?y[L].push(R+": "+j.value+"/"+c):y[L]=[R+": "+j.value+"/"+c];else{var z=a("circle",{cx:C,cy:I,r:dot_radius,fill:D,"data-title":j.name,"data-value":R+": "+j.value+"/"+c,"class":"graph_piece"});w.push(z)}}var P=a("polygon",{points:g.join(" "),fill:D,"fill-opacity":.5,stroke:D,"stroke-width":"0.5%","data-title":j.name,"data-value":j.value,"class":"graph_piece"});if(h.append(P),!edge_tooltips)for(var L=0;L<w.length;L++)h.append(w[L]);v.push({color:D,title:t[Q].title})}if(has_key)for(var G=(s-offset_top)/v.length,J=Math.min(5,G),Q=0;Q<v.length;Q++){var K=v[Q],U=a("circle",{cx:center_x+2*J,cy:offset_top+Q*G+J,r:J,fill:K.color,"class":"key_circle"}),V=a("text",{x:center_x+4*J,y:offset_top+Q*G+1.5*J,fill:r,"class":"key_text"},K.title);h.append(U),h.append(V)}if(title){var $=a("text",{x:n/2,y:5,fill:r,"text-anchor":"middle","class":"key_text"},title);h.append($)}if(d){var et=prettyNumber(100*m/_),tt="Fit: "+et+"%",at=a("text",{x:n/2,y:s-2,fill:r,"text-anchor":"middle","class":"key_text"},tt);h.append(at)}var rt=e('<div class="chart_tip"><span class="title"></span><span class="value"></span></div>').appendTo("body");return l.on("mouseover","path.graph_piece, circle.graph_piece",function(){rt.find("span.title").html(e(this).data("title")),e(this).data("value")&&!isNaN(e(this).data("value"))?rt.find("span.value").text(prettyNumber(e(this).data("value"))):rt.find("span.value").html(e(this).data("value")),rt.show()}),l.on("mouseleave","path.graph_piece, circle.graph_piece",function(){rt.hide()}),l.on("mousemove","path.graph_piece, circle.graph_piece",function(e){rt.css({left:e.pageX-rt.outerWidth()/2+"px",top:e.pageY-rt.outerHeight(!0)+"px"})}),l.addClass("chart").addClass("skew_chart"),has_key&&l.addClass("has_key"),l},e.fn.drawBar=function(t,l){for(var n,s=e(this),o=l.aspect_ratio?l.aspect_ratio:2,p=100*o,c=100,d=parseInt(l.bar_spacing),h=l.colors,u=(l.background_color||"#fff",l.title),v=l.hover,_=l.rounded_tops,f=l.average_line,g="undefined"==typeof l.goal_value?null:l.goal_value,x="undefined"==typeof l.height_adjustment?0:l.height_adjustment,m=(Math.cos,Math.sin,Math.PI,e('<svg width="100%" height="100%" viewBox="0, 0, '+p+", "+c+'" xmlns="http://www.w3.org/2000/svg"></svg>').appendTo(s)),y=f||null!==g?16:0,w=f||null!==g?8:0,k=p-y,M=v&&!u?c:c-10,b=M-10,L=0,j=1+x,C=p-k+d/2,I=M,P=(k-t.length*d)/t.length,N=0;N<t.length;N++)L+=t[N].value,t[N].value+x>j&&(j=t[N].value+x);if(f||null!==g){var A;f?(n=L/t.length,A=b*(n+x)/j):(n=g,A=b*(g+x)/j);var T=a("rect",{x:p-k,y:I-A,width:k,height:A,fill:"rgba(0, 0, 0, 0.1)"});m.append(T);var Z=["M",p-k,I-A,"L",p-k-w/2,I-A+w/2,"L",0,I-A+w/2,"L",0,I-A-w/2,"L",y-w/2,I-A-w/2,"Z"],B=a("path",{d:Z.join(" "),fill:i,"class":"goal_indicator"});m.append(B);var H=a("text",{x:(y-w/2)/2,y:I-A+w/2-2,"text-anchor":"middle",fill:"#fff","class":"goal_indicator_text"},prettyNumber(n));m.append(H)}if("undefined"!=typeof n)for(var N=0;N<t.length;N++){var W=t[N],X=b*Math.min(W.value+x,n+x)/j,Y=b*(W.value+x)/j,E=h[0],O=h[h.length-1],S=v?"graph_piece":"";if(Y>X){var D=I-X,F=Y-X,Q=["M",C,D,"L",C,D-F+Math.min(P/2,F),"A",P/2,Math.min(P/2,F),"0 0 1",C+P,D-F+Math.min(P/2,F),"L",C+P,D,"Z"],R=a("path",{d:Q.join(" "),fill:O,"data-title":W.name,"data-value":W.value,"class":S});m.append(R)}var q=["M",C,I,"L",C,I-X,"L",C+P,I-X,"L",C+P,I,"Z"],z=a("path",{d:q.join(" "),fill:E,"data-title":W.name,"data-value":W.value,"class":S});if(m.append(z),!v){var G=a("text",{x:C+P/2,y:I-Y-1,fill:r,"text-anchor":"middle","class":"key_text"},prettyNumber(W.value)),J=a("text",{x:C+P/2,y:c-1,fill:r,"text-anchor":"middle","class":"key_text"},W.name);m.append(G),m.append(J)}C+=P+d}else for(var N=0;N<t.length;N++){var W=t[N],Y=b*(W.value+x)/j,K=h[N%h.length],S=v?"graph_piece":"";if(_)var U=["M",C,I,"L",C,I-Y+Math.min(P/2,Y),"A",P/2,Math.min(P/2,Y),"0 0 1",C+P,I-Y+Math.min(P/2,Y),"L",C+P,I,"Z"];else var U=["M",C,I,"L",C,I-Y,"L",C+P,I-Y,"L",C+P,I,"Z"];var V=a("path",{d:U.join(" "),fill:K,"data-title":W.name,"data-value":W.value,"class":S});if(Y>0&&m.append(V),!v){var G=a("text",{x:C+P/2,y:I-Y-1,fill:r,"text-anchor":"middle","class":"key_text"},prettyNumber(W.value)),J=a("text",{x:C+P/2,y:c-1,fill:r,"text-anchor":"middle","class":"key_text"},W.name);m.append(G),m.append(J)}C+=P+d}if(v&&u)var $=a("text",{x:p/2,y:c-2,fill:r,"text-anchor":"middle","class":"key_text"},u);if(m.append($),v){var et=e('<div class="chart_tip"><span class="title"></span><span class="value"></span></div>').appendTo("body");s.on("mouseover","path.graph_piece",function(){et.find("span.title").html(e(this).data("title")),et.find("span.value").text(prettyNumber(e(this).data("value"))),et.show()}),s.on("mouseleave","path.graph_piece",function(){et.hide()}),s.on("mousemove","path.graph_piece",function(e){et.css({left:e.pageX-et.outerWidth()/2+"px",top:e.pageY-et.outerHeight(!0)+"px"})})}return s.addClass("chart").addClass("bar_chart"),s},e.fn.drawLine=function(t,i){for(var l=e(this),n=i.aspect_ratio?i.aspect_ratio:2,s=100*n,o=100,p=i.colors,c=(i.background_color||"#fff",i.title),d=i.hover,h=1.5,u="undefined"==typeof i.height_adjustment?0:i.height_adjustment,v=(Math.cos,Math.sin,Math.PI,e('<svg width="100%" height="100%" viewBox="0, 0, '+s+", "+o+'" xmlns="http://www.w3.org/2000/svg"></svg>').appendTo(l)),_=s-2*h,f=d&&!c?o:o-10,g=f-10,x=1+u,m=0;m<t.length;m++)for(var y=0;y<t[m].length;y++)t[m][y].value+u>x&&(x=t[m][y].value+u);for(var m=0;m<t.length;m++){for(var w=t[m].length>1?_/(t[m].length-1):_,M=(s-_)/2,b=[],L=[],j=p[m],y=0;y<t[m].length;y++){var C=t[m][y],I=M,P=f-g*(C.value+u)/x,N=C.value;C.hasOwnProperty("tooltip_value")&&(N=C.tooltip_value.constructor==Array?C.tooltip_value.join(", "):C.tooltip_value),b.push(I+","+P);var A=a("circle",{cx:I,cy:P,r:h,fill:j,"data-title":C.name,"data-value":N,"class":"graph_piece"});L.push(A),M+=w}var T=h+","+f,Z=h+_+","+f,B=a("polygon",{points:T+" "+b.join(" ")+" "+Z,fill:j,"fill-opacity":.5}),H=a("polyline",{points:b.join(" "),fill:"none","fill-opacity":.5,stroke:j,"stroke-width":"0.5%"});for(v.append(H),v.append(B),k=0;k<L.length;k++)v.append(L[k])}if(d&&c)var W=a("text",{x:s/2,y:o-2,fill:r,"text-anchor":"middle","class":"key_text"},c);if(v.append(W),d){var X=e('<div class="chart_tip"><span class="title"></span><span class="value"></span></div>').appendTo("body");l.on("mouseover","polygon.graph_piece, circle.graph_piece",function(){X.find("span.title").html(e(this).data("title")),X.find("span.value").text(e(this).data("value")),X.show()}),l.on("mouseleave","polygon.graph_piece, circle.graph_piece",function(){X.hide()}),l.on("mousemove","polygon.graph_piece, circle.graph_piece",function(e){X.css({left:e.pageX-X.outerWidth()/2+"px",top:e.pageY-X.outerHeight(!0)+"px"})})}return l.addClass("chart").addClass("bar_chart"),l},e.fn.drawComparison=function(t,i){for(var l=e(this),n=i.aspect_ratio?i.aspect_ratio:1,s=100*n,o=100,p=i.colors,c=i.shapes,d=(i.background_color||"#fff",i.title),h=i.hover,u=h?"graph_piece":"",v=(Math.cos,Math.sin,Math.PI,e('<svg width="100%" height="100%" viewBox="0, 0, '+s+", "+o+'" xmlns="http://www.w3.org/2000/svg"></svg>').appendTo(l)),_=0,f=0,g=0;g<t.length;g++)_+=t[g].value;var x=0,m=h&&!d?o:o-10,y=m;if(_>0)for(var g=0;g<t.length;g++){var w=t[g],k=p[g%p.length],M=c[g%c.length],b=Math.round(w.value/_*100)/100,L=w.value/_*(m/100),j=Math.round(L*s*100)/100,C=Math.round(L*o*100)/100;f+=b,f>1&&(b-=.01);var I=a("path",{d:M,fill:k,"data-title":w.name,"data-value":Math.round(100*b)+"%","class":u,transform:"translate("+x+", "+(y-C)+"), scale("+L+")"});if(v.append(I),!h){var P=a("text",{x:x+j/2,y:y-C-1,fill:r,"text-anchor":"middle","class":"key_text large"},Math.round(100*b)+"%"),N=a("text",{x:x+j/2,y:o-1,fill:r,"text-anchor":"middle","class":"key_text"},w.name);v.append(P),v.append(N)}x+=j,d&&(x+=10/(t.length-1))}if(h&&d)var A=a("text",{x:s/2,y:o-2,fill:r,"text-anchor":"middle","class":"key_text"},d);if(v.append(A),h){var T=e('<div class="chart_tip"><span class="title"></span><span class="value"></span></div>').appendTo("body");l.on("mouseover","path.graph_piece",function(){T.find("span.title").html(e(this).data("title")),T.find("span.value").text(e(this).data("value")),T.show()}),l.on("mouseleave","path.graph_piece",function(){T.hide()}),l.on("mousemove","path.graph_piece",function(e){T.css({left:e.pageX-T.outerWidth()/2+"px",top:e.pageY-T.outerHeight(!0)+"px"})})}return l.addClass("chart").addClass("comparison_chart"),l}}(jQuery);